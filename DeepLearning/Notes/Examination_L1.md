# L1Week2

## 1-numpy

### 1.1-sigmoid functionå’Œnp.expï¼ˆï¼‰

â€‹	åœ¨ä½¿ç”¨np.expï¼ˆï¼‰ä¹‹å‰ï¼Œä½ å°†ä½¿ç”¨math.expï¼ˆï¼‰å®ç°Sigmoidå‡½æ•°ã€‚ç„¶åï¼Œä½ å°†çŸ¥é“ä¸ºä»€ä¹ˆnp.expï¼ˆï¼‰æ¯”math.expï¼ˆï¼‰æ›´å¯å–ã€‚

**ç»ƒä¹ **ï¼šæ„å»ºä¸€ä¸ªè¿”å›å®æ•°xçš„sigmoidçš„å‡½æ•°ã€‚å°†math.expï¼ˆxï¼‰ç”¨äºæŒ‡æ•°å‡½æ•°ã€‚

![image-20240523132329935](images/image-20240523132329935.png)

â€‹	ä¹Ÿç§°ä¸ºé€»è¾‘å‡½æ•°ã€‚ä¸€ç§éçº¿æ€§å‡½æ•°ï¼Œå³å¯ç”¨äºæœºå™¨å­¦ä¹ ï¼ˆé€»è¾‘å›å½’ï¼‰ï¼Œä¹Ÿèƒ½ç”¨äºæ·±åº¦å­¦ä¹ ã€‚

â€‹	æ·±åº¦å­¦ä¹ ä¸­ä¸»è¦ä½¿ç”¨çš„æ˜¯çŸ©é˜µå’Œå‘é‡ï¼Œå› æ­¤numpyæ›´ä¸ºå®ç”¨ï¼Œå¯¹äºä½¿ç”¨mathå†™çš„sigmidå‡½æ•°ï¼Œå¦‚æœä¼ å…¥å‘é‡æˆ–è€…çŸ©é˜µä¼šæŠ¥ç±»å‹ä¸åŒ¹é…çš„é”™è¯¯ï¼Œå› æ­¤ä½¿ç”¨np.exp()ã€‚

â€‹	å¦‚æœ![image-20240523133219046](images/image-20240523133219046.png)æ˜¯è¡Œå‘é‡ï¼Œåˆ™![image-20240523133230569](images/image-20240523133230569.png)ä¼šå°†æŒ‡æ•°å‡½æ•°åº”ç”¨äºxçš„æ¯ä¸ªå…ƒç´ ã€‚è¾“å‡ºä¸ºï¼š![image-20240523133247952](images/image-20240523133247952.png)

```python
import math 
import numpy as np

# example of np.exp
x = np.array([1, 2, 3])
print(np.exp(x)) # result is (exp(1), exp(2), exp(3))
```

output:

```python
[ 2.71828183  7.3890561  20.08553692]
```

å¦‚æœxæ˜¯å‘é‡ï¼Œåˆ™ğ‘ =ğ‘¥+3æˆ–![image-20240523133848886](images/image-20240523133848886.png)ä¹‹ç±»çš„Pythonè¿ç®—å°†è¾“å‡ºä¸xç»´åº¦å¤§å°ç›¸åŒçš„å‘é‡sã€‚

```PY
x = np.array([1, 2, 3])
print (x + 3)
```

outputï¼š

```python
[4 5 6]
```

ç»¼ä¸Šï¼Œå¯¹äºnp.exp()æ‰€å®ç°çš„sigmoidå‡½æ•°ï¼Œå¯ä»¥è¾“å…¥çŸ©é˜µï¼Œå‘é‡ç­‰ï¼Œè¾“å‡ºè¾“å…¥å¦‚ä¸‹æ‰€ç¤ºã€‚

![image-20240523134217046](images/image-20240523134217046.png)

```python
def sigmoid(x):

    s = 1 / (1 + np.exp(-x))
    
    return s
```



### 1.2- Sigmoid gradient

**ç»ƒä¹ **ï¼šåˆ›å»ºå‡½æ•°sigmoid_gradï¼ˆï¼‰è®¡ç®—sigmoidå‡½æ•°ç›¸å¯¹äºå…¶è¾“å…¥xçš„æ¢¯åº¦ã€‚ å…¬å¼ä¸ºï¼š

â€‹	æ­¤å¤„å¯¹åº”äºäºŒåˆ†æ³•ï¼Œxä¸€èˆ¬ä¸ºw^T*x+bï¼Œä½¿ç”¨æ¢¯åº¦ä¸‹é™æ³•çš„æ—¶å€™ä¼šä»æˆæœ¬å‡½æ•°ä¸€æ­¥æ­¥å‘å‰æ±‚åå¯¼ï¼Œä»¥æ‰¾åˆ°æˆæœ¬å‡½æ•°æœ€å°çš„å€¼ä¸ç‚¹ï¼Œåˆç†åˆ©ç”¨é“¾å¼æ³•åˆ™ä»¥æ±‚å¾—ç›¸åº”çš„å¯¼æ•°ã€‚

![image-20240523134357263](images/image-20240523134357263.png)

```python
def sigmoid_derivative(x):
    s = sigmoid(x)
    ds = s * (1-s)
    return ds

x = np.array([1, 2, 3])
print ("sigmoid_derivative(x) = " + str(sigmoid_derivative(x)))
```

output:

```PYTHON
sigmoid_derivative(x) = [0.19661193 0.10499359 0.04517666]
```

### 1.3- é‡å¡‘æ•°ç»„

æ·±åº¦å­¦ä¹ ä¸­ä¸¤ä¸ªå¸¸ç”¨çš„numpyå‡½æ•°æ˜¯np.shape()å’Œnp.reshape()ã€‚
-X.shapeç”¨äºè·å–çŸ©é˜µ/å‘é‡Xçš„shapeï¼ˆç»´åº¦ï¼‰ã€‚
-X.reshapeï¼ˆ...ï¼‰ç”¨äºå°†Xé‡å¡‘ä¸ºå…¶ä»–å°ºå¯¸ã€‚

ä¾‹å¦‚ï¼Œåœ¨è®¡ç®—æœºç§‘å­¦ä¸­ï¼Œå›¾åƒç”±shapeä¸º(ğ‘™ğ‘’ğ‘›ğ‘”ğ‘¡â„,â„ğ‘’ğ‘–ğ‘”â„ğ‘¡,ğ‘‘ğ‘’ğ‘ğ‘¡â„=3)çš„3Dæ•°ç»„è¡¨ç¤ºï¼Œï¼ˆé•¿ï¼Œå®½ï¼ŒRGB=3ï¼‰ä½†æ˜¯ï¼Œå½“ä½ è¯»å–å›¾åƒä½œä¸ºç®—æ³•çš„è¾“å…¥æ—¶ï¼Œä¼šå°†å…¶è½¬æ¢ä¸ºç»´åº¦ä¸º(ğ‘™ğ‘’ğ‘›ğ‘”ğ‘¡â„âˆ—â„ğ‘’ğ‘–ğ‘”â„ğ‘¡âˆ—3,1)çš„å‘é‡ã€‚æ¢å¥è¯è¯´ï¼Œå°†3Dé˜µåˆ—â€œå±•å¼€â€æˆ–é‡å¡‘ä¸º1Då‘é‡ã€‚

![image-20240523135829704](images/image-20240523135829704.png)

**ç»ƒä¹ **ï¼šå®ç°`image2vector()` ,è¯¥è¾“å…¥é‡‡ç”¨ç»´åº¦ä¸º(length, height, 3)çš„è¾“å…¥ï¼Œå¹¶è¿”å›ç»´åº¦ä¸º(length\*height\*3 , 1)çš„å‘é‡ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ æƒ³å°†å½¢ä¸ºï¼ˆaï¼Œbï¼Œcï¼‰çš„æ•°ç»„vé‡å¡‘ä¸ºç»´åº¦ä¸º(a*b, 3)çš„å‘é‡ï¼Œåˆ™å¯ä»¥æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š

```python
v = v.reshape((v.shape[0]*v.shape[1], v.shape[2])) # v.shape[0] = a ; v.shape[1] = b ; v.shape[2] = c
```

-è¯·ä¸è¦å°†å›¾åƒçš„å°ºå¯¸ç¡¬ç¼–ç ä¸ºå¸¸æ•°ã€‚è€Œæ˜¯é€šè¿‡image.shape [0]ç­‰æ¥æŸ¥æ‰¾æ‰€éœ€çš„æ•°é‡ã€‚

```python
def image2vector(image):

    v = image.reshape(image.shape[0] * image.shape[1] * image.shape[2], 1)

    return v



image = np.array([[[ 0.67826139,  0.29380381],
        [ 0.90714982,  0.52835647],
        [ 0.4215251 ,  0.45017551]],

       [[ 0.92814219,  0.96677647],
        [ 0.85304703,  0.52351845],
        [ 0.19981397,  0.27417313]],

       [[ 0.60659855,  0.00533165],
        [ 0.10820313,  0.49978937],
        [ 0.34144279,  0.94630077]]])

print ("image2vector(image) = " + str(image2vector(image)))
```

output:

```python
image2vector(image) = [[0.67826139]
 [0.29380381]
 [0.90714982]
 [0.52835647]
 [0.4215251 ]
 [0.45017551]
 [0.92814219]
 [0.96677647]
 [0.85304703]
 [0.52351845]
 [0.19981397]
 [0.27417313]
 [0.60659855]
 [0.00533165]
 [0.10820313]
 [0.49978937]
 [0.34144279]
 [0.94630077]]
```

### 1.4-è¡Œæ ‡å‡†åŒ–

â€‹	å¯¹æ•°æ®è¿›è¡Œæ ‡å‡†åŒ–ï¼ˆå½’ä¸€åŒ–ï¼‰ã€‚ ç”±äºå½’ä¸€åŒ–åæ¢¯åº¦ä¸‹é™çš„æ”¶æ•›é€Ÿåº¦æ›´å¿«ï¼Œé€šå¸¸ä¼šè¡¨ç°å‡ºæ›´å¥½çš„æ•ˆæœã€‚ é€šè¿‡å½’ä¸€åŒ–ï¼Œä¹Ÿå°±æ˜¯å°†xæ›´æ”¹ä¸º![image-20240523141832233](images/image-20240523141832233.png)ï¼ˆå°†xçš„æ¯ä¸ªè¡Œå‘é‡é™¤ä»¥å…¶èŒƒæ•°ï¼ˆæ¨¡å€¼ï¼‰)ã€‚

ä¾‹å¦‚ï¼š

![image-20240523141947128](images/image-20240523141947128.png)

then

![image-20240523141954325](images/image-20240523141954325.png)

and

![image-20240523141958558](images/image-20240523141958558.png)

**ç»ƒä¹ **ï¼šæ‰§è¡Œ normalizeRowsï¼ˆï¼‰æ¥æ ‡å‡†åŒ–çŸ©é˜µçš„è¡Œã€‚ å°†æ­¤å‡½æ•°åº”ç”¨äºè¾“å…¥çŸ©é˜µxä¹‹åï¼Œxçš„æ¯ä¸€è¡Œåº”ä¸ºå•ä½é•¿åº¦ï¼ˆå³é•¿åº¦ä¸º1ï¼‰å‘é‡ã€‚

```python
#linalg = linearï¼ˆçº¿æ€§ï¼‰+ algebraï¼ˆä»£æ•°ï¼‰ï¼Œnormåˆ™è¡¨ç¤ºèŒƒæ•°ã€‚
#x_norm=np.linalg.norm(x, ord=None, axis=None, keepdims=False)
```

- x: è¡¨ç¤ºçŸ©é˜µï¼ˆä¹Ÿå¯ä»¥æ˜¯ä¸€ç»´ï¼‰

- ordï¼šèŒƒæ•°ç±»å‹

  ![image-20240523142909611](images/image-20240523142909611.png)

- axis, axis=0 è¡¨ç¤ºæŒ‰åˆ—å‘é‡æ¥è¿›è¡Œå¤„ç†ï¼Œæ±‚å¤šä¸ªåˆ—å‘é‡çš„èŒƒæ•°; axis =1 è¡¨ç¤ºæŒ‰è¡Œå‘é‡æ¥è¿›è¡Œå¤„ç†ï¼Œæ±‚å¤šä¸ªè¡Œå‘é‡çš„èŒƒæ•°

- keepdimsï¼šè¡¨ç¤ºæ˜¯å¦ä¿æŒçŸ©é˜µçš„äºŒç»´ç‰¹æ€§ï¼ŒTrueè¡¨ç¤ºä¿æŒï¼ŒFalseè¡¨ç¤ºä¸ä¿æŒï¼Œé»˜è®¤ä¸ºFalse

```python
def normalizeRows(x):
    x_norm = np.linalg.norm(x, axis = 1, keepdims = True)
    # Divide x by its norm.
    x = x / x_norm
    ### END CODE HERE ###

    return x

x = np.array([
    [0, 3, 4],
    [1, 6, 4]])
print("normalizeRows(x) = " + str(normalizeRows(x)))
```

outputï¼š

```PYTHON
normalizeRows(x) = [[0.         0.6        0.8       ]
 [0.13736056 0.82416338 0.54944226]]
```

**æ³¨æ„**ï¼š
åœ¨normalizeRowsï¼ˆï¼‰ä¸­ï¼Œå°è¯•printæŸ¥çœ‹ x_normå’Œxçš„ç»´åº¦ï¼Œ ä¼šå‘ç°å®ƒä»¬å…·æœ‰ä¸åŒçš„wç»´åº¦ã€‚ é‰´äºx_normé‡‡ç”¨xçš„æ¯ä¸€è¡Œçš„èŒƒæ•°ï¼Œè¿™æ˜¯æ­£å¸¸çš„ã€‚ å› æ­¤ï¼Œx_normå…·æœ‰ç›¸åŒçš„è¡Œæ•°ï¼Œä½†åªæœ‰1åˆ—ã€‚ é‚£ä¹ˆï¼Œå½“ä½ å°†xé™¤ä»¥x_normæ—¶ï¼Œå®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ è¿™å°±æ˜¯æ‰€è°“çš„å¹¿æ’­broadcastingï¼Œæˆ‘ä»¬ç°åœ¨å°†è®¨è®ºå®ƒï¼

æ­¤å¤„å¯¹åº”çš„æ˜¯ç¬”è®°ä¸­çš„å¹¿æ’­ï¼Œé€šä¿—æ¥è®²å°±æ˜¯ä¼šæ™ºèƒ½åŒ–è§£å†³ç»´åº¦ä¸åŒ¹é…çš„é—®é¢˜ã€‚

### 1.5- å¹¿æ’­å’Œsoftmaxå‡½æ•°

åœ¨numpyä¸­è¦ç†è§£çš„ä¸€ä¸ªéå¸¸é‡è¦çš„æ¦‚å¿µæ˜¯â€œå¹¿æ’­â€ã€‚ è¿™å¯¹äºåœ¨ä¸åŒå½¢çŠ¶çš„æ•°ç»„ä¹‹é—´æ‰§è¡Œæ•°å­¦è¿ç®—éå¸¸æœ‰ç”¨ã€‚

**ç»ƒä¹ **: ä½¿ç”¨numpyå®ç°softmaxå‡½æ•°ã€‚ ä½ å¯ä»¥å°†softmaxç†è§£ä¸ºç®—æ³•éœ€è¦å¯¹ä¸¤ä¸ªæˆ–å¤šä¸ªç±»è¿›è¡Œåˆ†ç±»æ—¶ä½¿ç”¨çš„æ ‡å‡†åŒ–å‡½æ•°ã€‚

â€‹	ç®€è€Œè¨€ä¹‹ï¼Œè¾“å…¥ä¸€ä¸ªçŸ©é˜µï¼Œå–eæŒ‡æ•°åæ¯è¡Œè¿›è¡Œå•ä½åŒ–ï¼Œå¯¹äºè¿™ä¸ªå‡½æ•°æœ‰ä»€ä¹ˆä½œç”¨å°†åœ¨æœ¬ä¸“ä¸šçš„ç¬¬äºŒé—¨è¯¾ä¸­äº†è§£æœ‰å…³softmaxçš„æ›´å¤šä¿¡æ¯ã€‚

![image-20240523144022058](images/image-20240523144022058.png)

```python
def softmax(x):

    x_exp = np.exp(x)

    x_sum = np.sum(x_exp, axis = 1, keepdims = True)

    s = x_exp / x_sum
    
    return s


x = np.array([
    [9, 2, 5, 0, 0],
    [7, 5, 0, 0 ,0]])
print("softmax(x) = " + str(softmax(x)))
```

output:

```PYTHON
softmax(x) = [[9.80897665e-01 8.94462891e-04 1.79657674e-02 1.21052389e-04
  1.21052389e-04]
 [8.78679856e-01 1.18916387e-01 8.01252314e-04 8.01252314e-04
  8.01252314e-04]]
```

## 2-å‘é‡åŒ–

â€‹	åœ¨æ·±åº¦å­¦ä¹ ä¸­ï¼Œé€šå¸¸éœ€è¦å¤„ç†éå¸¸å¤§çš„æ•°æ®é›†ã€‚ å› æ­¤ï¼Œéè®¡ç®—æœ€ä½³å‡½æ•°å¯èƒ½ä¼šæˆä¸ºç®—æ³•ä¸­çš„å·¨å¤§ç“¶é¢ˆï¼Œå¹¶å¯èƒ½ä½¿æ¨¡å‹è¿è¡Œä¸€æ®µæ—¶é—´ã€‚ ä¸ºäº†ç¡®ä¿ä»£ç çš„é«˜æ•ˆè®¡ç®—ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨å‘é‡åŒ–ã€‚ ä¾‹å¦‚ï¼Œå°è¯•åŒºåˆ†ç‚¹/å¤–éƒ¨/å…ƒç´ ä¹˜ç§¯ä¹‹é—´çš„åŒºåˆ«ã€‚

â€‹	ä¸‹æ–¹è¿ç®—æ—¶é—´ä¸º0ï¼Œdicã€docç›¸åŒï¼Œç”µè„‘è¿ç®—å¤ªå¿«ï¼Œä»£ç å¤ªå°‘ï¼Œformatå‡½æ•°ç²¾ç¡®åˆ°åå…«ä½éƒ½æ˜¯0ã€‚

â€‹	ä½†å¤§è¿ç®—é‡é¿å…ä½¿ç”¨æ˜¾ç¤ºforï¼Œä½¿ç”¨npå‡½æ•°åº“ã€‚

### **ç‚¹ç§¯(dot product)**

åˆå«æ ‡é‡ç§¯ã€æ•°é‡ç§¯ã€‚

â€‹	![image-20240523163946065](images/image-20240523163946065.png)

forç‰ˆæœ¬ï¼š

```python
import time

x1 = [9, 2, 5, 0, 0, 7, 5, 0, 0, 0, 9, 2, 5, 0, 0]
x2 = [9, 2, 2, 9, 0, 9, 2, 5, 0, 0, 9, 2, 5, 0, 0]

### CLASSIC DOT PRODUCT OF VECTORS IMPLEMENTATION ###
tic = time.process_time()
dot = 0
for i in range(len(x1)):
    dot+= x1[i]*x2[i]
toc = time.process_time()
print ("dot = " + str(dot) + "\n ----- Computation time = " + str(1000*(toc - tic)) + "ms")
```

npç‰ˆæœ¬ï¼š

```PYTHON
x1 = [9, 2, 5, 0, 0, 7, 5, 0, 0, 0, 9, 2, 5, 0, 0]
x2 = [9, 2, 2, 9, 0, 9, 2, 5, 0, 0, 9, 2, 5, 0, 0]

### VECTORIZED DOT PRODUCT OF VECTORS ###
tic = time.process_time()
dot = np.dot(x1,x2)
toc = time.process_time()
print ("dot = " + str(dot) + "\n ----- Computation time = " + str(1000*(toc - tic)) + "ms")
```



output:

```PYTHON
dot = 278
 ----- Computation time = 0.0ms
```



### **å‰ç§¯(corss product)**

â€‹	æˆ–å‘é‡ç§¯(vector product )

![image-20240523164123958](images/image-20240523164123958.png)

### **å¤–ç§¯(outer product)**

åœ¨çº¿æ€§ä»£æ•°ä¸­ï¼Œä¸¤ä¸ªåæ ‡å‘é‡çš„å¤–ç§¯æ˜¯ä¸€ä¸ªçŸ©é˜µã€‚å¦‚æœè¿™ä¸¤ä¸ªå‘é‡çš„ç»´åº¦æ˜¯*n*å’Œ*m*ï¼Œé‚£ä¹ˆå®ƒä»¬çš„å¤–ç§¯æ˜¯ä¸€ä¸ª*n* Ã— *m*çŸ©é˜µã€‚æ›´ä¸€èˆ¬åœ°è¯´ï¼Œç»™å®šä¸¤ä¸ªå¼ é‡ï¼ˆå¤šç»´æ•°å­—æ•°ç»„ï¼‰ï¼Œå®ƒä»¬çš„å¤–ç§¯æ˜¯å¼ é‡ã€‚å¼ é‡çš„å¤–ç§¯ä¹Ÿç§°ä¸ºå¼ é‡ç§¯ï¼Œå¯ç”¨äºå®šä¹‰å¼ é‡ä»£æ•°ã€‚

![image-20240523164405819](images/image-20240523164405819.png)

forç‰ˆæœ¬:

```PYTHON
### CLASSIC OUTER PRODUCT IMPLEMENTATION ###
tic = time.process_time()
outer = np.zeros((len(x1),len(x2))) # we create a len(x1)*len(x2) matrix with only zeros
for i in range(len(x1)):
    for j in range(len(x2)):
        outer[i,j] = x1[i]*x2[j]
toc = time.process_time()
print ("outer = " + str(outer) + "\n ----- Computation time = " + str(1000*(toc - tic)) + "ms")
```

npç‰ˆæœ¬ï¼š

```PYTHON
### VECTORIZED OUTER PRODUCT ###
tic = time.process_time()
outer = np.outer(x1,x2)
toc = time.process_time()
print ("outer = " + str(outer) + "\n ----- Computation time = " + str(1000*(toc - tic)) + "ms")
```



output:

```PYTHON
outer = [[81. 18. 18. 81.  0. 81. 18. 45.  0.  0. 81. 18. 45.  0.  0.]
 [18.  4.  4. 18.  0. 18.  4. 10.  0.  0. 18.  4. 10.  0.  0.]
 [45. 10. 10. 45.  0. 45. 10. 25.  0.  0. 45. 10. 25.  0.  0.]
 [ 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.]
 [ 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.]
 [63. 14. 14. 63.  0. 63. 14. 35.  0.  0. 63. 14. 35.  0.  0.]
 [45. 10. 10. 45.  0. 45. 10. 25.  0.  0. 45. 10. 25.  0.  0.]
 [ 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.]
 [ 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.]
 [ 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.]
 [81. 18. 18. 81.  0. 81. 18. 45.  0.  0. 81. 18. 45.  0.  0.]
 [18.  4.  4. 18.  0. 18.  4. 10.  0.  0. 18.  4. 10.  0.  0.]
 [45. 10. 10. 45.  0. 45. 10. 25.  0.  0. 45. 10. 25.  0.  0.]
 [ 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.]
 [ 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.]]
 ----- Computation time = 0.0ms
```

â€‹	ä¸åŒäº`np.multiply()`å’Œ`*` æ“ä½œç¬¦ï¼ˆç›¸å½“äºMatlab / Octaveä¸­çš„ `.*`ï¼‰æ‰§è¡Œé€å…ƒç´ çš„ä¹˜æ³•ï¼Œ`np.dot()`æ‰§è¡Œçš„æ˜¯çŸ©é˜µ-çŸ©é˜µæˆ–çŸ©é˜µå‘é‡ä¹˜æ³•ï¼Œ

### 2.1-å®ç°L1å’ŒL2æŸå¤±å‡½æ•°

**ç»ƒä¹ **ï¼šå®ç°L1æŸå¤±å‡½æ•°çš„Numpyå‘é‡åŒ–ç‰ˆæœ¬ã€‚ æˆ‘ä»¬ä¼šå‘ç°å‡½æ•°absï¼ˆxï¼‰ï¼ˆxçš„ç»å¯¹å€¼ï¼‰å¾ˆæœ‰ç”¨ã€‚

**æç¤º**ï¼š
-æŸå¤±å‡½æ•°ç”¨äºè¯„ä¼°æ¨¡å‹çš„æ€§èƒ½ã€‚ æŸå¤±è¶Šå¤§ï¼Œé¢„æµ‹![image-20240523170837643](images/image-20240523170837643.png) ä¸çœŸå®å€¼![image-20240523170844510](images/image-20240523170844510.png)çš„å·®å¼‚ä¹Ÿå°±è¶Šå¤§ã€‚ åœ¨æ·±åº¦å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨è¯¸å¦‚Gradient Descentä¹‹ç±»çš„ä¼˜åŒ–ç®—æ³•æ¥è®­ç»ƒæ¨¡å‹å¹¶æœ€å¤§ç¨‹åº¦åœ°é™ä½æˆæœ¬ã€‚

- L1æŸå¤±å‡½æ•°å®šä¹‰ä¸ºï¼š

![image-20240523170721050](images/image-20240523170721050.png)

```PYTHON
def L1(yhat, y):
    loss = np.sum(np.abs(y - yhat))
    return loss

yhat = np.array([.9, 0.2, 0.1, .4, .9])
y = np.array([1, 0, 0, 1, 1])
print("L1 = " + str(L1(yhat,y)))
```

output:

```python
L1 = 1.1
```

**ç»ƒä¹ **ï¼šå®ç°L2æŸå¤±å‡½æ•°çš„Numpyå‘é‡åŒ–ç‰ˆæœ¬ã€‚ æœ‰å¥½å‡ ç§æ–¹æ³•å¯ä»¥å®ç°L2æŸå¤±å‡½æ•°ï¼Œä½†æ˜¯è¿˜æ˜¯np.dotï¼ˆï¼‰å‡½æ•°æ›´å¥½ç”¨ã€‚ æé†’ä¸€ä¸‹ï¼Œå¦‚æœğ‘¥=[ğ‘¥1,ğ‘¥2,...,ğ‘¥ğ‘›]ï¼Œåˆ™`np.dotï¼ˆxï¼Œxï¼‰`=![image-20240523171230965](images/image-20240523171230965.png)

- L2æŸå¤±å‡½æ•°å®šä¹‰ä¸ºï¼š

![image-20240523171322543](images/image-20240523171322543.png)

æ­¤ç§ç®—æ³•æ˜¯ä¸Šè¿°æåˆ°çš„çŸ©é˜µçš„ç‚¹ç§¯ç®—æ³•ã€‚

```python
def L2(yhat, y):
    loss = np.dot((y - yhat),(y - yhat).T)
    return loss


yhat = np.array([.9, 0.2, 0.1, .4, .9])
y = np.array([1, 0, 0, 1, 1])
print("L2 = " + str(L2(yhat,y)))
```

output:

```python
L2 = 0.43
```

