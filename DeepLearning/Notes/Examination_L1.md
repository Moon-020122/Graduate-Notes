# numpyåŸºç¡€

## 1-ä½¿ç”¨numpyæ„å»ºåŸºæœ¬å‡½æ•°

### 1.1-sigmoid functionå’Œnp.expï¼ˆï¼‰

â€‹	åœ¨ä½¿ç”¨np.expï¼ˆï¼‰ä¹‹å‰ï¼Œä½ å°†ä½¿ç”¨math.expï¼ˆï¼‰å®ç°Sigmoidå‡½æ•°ã€‚ç„¶åï¼Œä½ å°†çŸ¥é“ä¸ºä»€ä¹ˆnp.expï¼ˆï¼‰æ¯”math.expï¼ˆï¼‰æ›´å¯å–ã€‚

**ç»ƒä¹ **ï¼šæ„å»ºä¸€ä¸ªè¿”å›å®æ•°xçš„sigmoidçš„å‡½æ•°ã€‚å°†math.expï¼ˆxï¼‰ç”¨äºæŒ‡æ•°å‡½æ•°ã€‚

![image-20240523132329935](images/image-20240523132329935.png)

â€‹	ä¹Ÿç§°ä¸ºé€»è¾‘å‡½æ•°ã€‚ä¸€ç§éçº¿æ€§å‡½æ•°ï¼Œå³å¯ç”¨äºæœºå™¨å­¦ä¹ ï¼ˆé€»è¾‘å›å½’ï¼‰ï¼Œä¹Ÿèƒ½ç”¨äºæ·±åº¦å­¦ä¹ ã€‚

â€‹	æ·±åº¦å­¦ä¹ ä¸­ä¸»è¦ä½¿ç”¨çš„æ˜¯çŸ©é˜µå’Œå‘é‡ï¼Œå› æ­¤numpyæ›´ä¸ºå®ç”¨ï¼Œå¯¹äºä½¿ç”¨mathå†™çš„sigmidå‡½æ•°ï¼Œå¦‚æœä¼ å…¥å‘é‡æˆ–è€…çŸ©é˜µä¼šæŠ¥ç±»å‹ä¸åŒ¹é…çš„é”™è¯¯ï¼Œå› æ­¤ä½¿ç”¨np.exp()ã€‚

â€‹	å¦‚æœ![image-20240523133219046](images/image-20240523133219046.png)æ˜¯è¡Œå‘é‡ï¼Œåˆ™![image-20240523133230569](images/image-20240523133230569.png)ä¼šå°†æŒ‡æ•°å‡½æ•°åº”ç”¨äºxçš„æ¯ä¸ªå…ƒç´ ã€‚è¾“å‡ºä¸ºï¼š![image-20240523133247952](images/image-20240523133247952.png)

```python
import math 
import numpy as np

# example of np.exp
x = np.array([1, 2, 3])
print(np.exp(x)) # result is (exp(1), exp(2), exp(3))
```

output:

```python
[ 2.71828183  7.3890561  20.08553692]
```

å¦‚æœxæ˜¯å‘é‡ï¼Œåˆ™ğ‘ =ğ‘¥+3æˆ–![image-20240523133848886](images/image-20240523133848886.png)ä¹‹ç±»çš„Pythonè¿ç®—å°†è¾“å‡ºä¸xç»´åº¦å¤§å°ç›¸åŒçš„å‘é‡sã€‚

```PY
x = np.array([1, 2, 3])
print (x + 3)
```

outputï¼š

```python
[4 5 6]
```

ç»¼ä¸Šï¼Œå¯¹äºnp.exp()æ‰€å®ç°çš„sigmoidå‡½æ•°ï¼Œå¯ä»¥è¾“å…¥çŸ©é˜µï¼Œå‘é‡ç­‰ï¼Œè¾“å‡ºè¾“å…¥å¦‚ä¸‹æ‰€ç¤ºã€‚

![image-20240523134217046](images/image-20240523134217046.png)

```python
def sigmoid(x):

    s = 1 / (1 + np.exp(-x))
    
    return s
```



### 1.2- Sigmoid gradient

**ç»ƒä¹ **ï¼šåˆ›å»ºå‡½æ•°sigmoid_gradï¼ˆï¼‰è®¡ç®—sigmoidå‡½æ•°ç›¸å¯¹äºå…¶è¾“å…¥xçš„æ¢¯åº¦ã€‚ å…¬å¼ä¸ºï¼š

â€‹	æ­¤å¤„å¯¹åº”äºäºŒåˆ†æ³•ï¼Œxä¸€èˆ¬ä¸ºw^T*x+bï¼Œä½¿ç”¨æ¢¯åº¦ä¸‹é™æ³•çš„æ—¶å€™ä¼šä»æˆæœ¬å‡½æ•°ä¸€æ­¥æ­¥å‘å‰æ±‚åå¯¼ï¼Œä»¥æ‰¾åˆ°æˆæœ¬å‡½æ•°æœ€å°çš„å€¼ä¸ç‚¹ï¼Œåˆç†åˆ©ç”¨é“¾å¼æ³•åˆ™ä»¥æ±‚å¾—ç›¸åº”çš„å¯¼æ•°ã€‚

![image-20240523134357263](images/image-20240523134357263.png)

```python
def sigmoid_derivative(x):
    s = sigmoid(x)
    ds = s * (1-s)
    return ds

x = np.array([1, 2, 3])
print ("sigmoid_derivative(x) = " + str(sigmoid_derivative(x)))
```

output:

```PYTHON
sigmoid_derivative(x) = [0.19661193 0.10499359 0.04517666]
```

### 1.3- é‡å¡‘æ•°ç»„

æ·±åº¦å­¦ä¹ ä¸­ä¸¤ä¸ªå¸¸ç”¨çš„numpyå‡½æ•°æ˜¯np.shape()å’Œnp.reshape()ã€‚
-X.shapeç”¨äºè·å–çŸ©é˜µ/å‘é‡Xçš„shapeï¼ˆç»´åº¦ï¼‰ã€‚
-X.reshapeï¼ˆ...ï¼‰ç”¨äºå°†Xé‡å¡‘ä¸ºå…¶ä»–å°ºå¯¸ã€‚

ä¾‹å¦‚ï¼Œåœ¨è®¡ç®—æœºç§‘å­¦ä¸­ï¼Œå›¾åƒç”±shapeä¸º(ğ‘™ğ‘’ğ‘›ğ‘”ğ‘¡â„,â„ğ‘’ğ‘–ğ‘”â„ğ‘¡,ğ‘‘ğ‘’ğ‘ğ‘¡â„=3)çš„3Dæ•°ç»„è¡¨ç¤ºï¼Œï¼ˆé•¿ï¼Œå®½ï¼ŒRGB=3ï¼‰ä½†æ˜¯ï¼Œå½“ä½ è¯»å–å›¾åƒä½œä¸ºç®—æ³•çš„è¾“å…¥æ—¶ï¼Œä¼šå°†å…¶è½¬æ¢ä¸ºç»´åº¦ä¸º(ğ‘™ğ‘’ğ‘›ğ‘”ğ‘¡â„âˆ—â„ğ‘’ğ‘–ğ‘”â„ğ‘¡âˆ—3,1)çš„å‘é‡ã€‚æ¢å¥è¯è¯´ï¼Œå°†3Dé˜µåˆ—â€œå±•å¼€â€æˆ–é‡å¡‘ä¸º1Då‘é‡ã€‚

![image-20240523135829704](images/image-20240523135829704.png)

**ç»ƒä¹ **ï¼šå®ç°`image2vector()` ,è¯¥è¾“å…¥é‡‡ç”¨ç»´åº¦ä¸º(length, height, 3)çš„è¾“å…¥ï¼Œå¹¶è¿”å›ç»´åº¦ä¸º(length\*height\*3 , 1)çš„å‘é‡ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ æƒ³å°†å½¢ä¸ºï¼ˆaï¼Œbï¼Œcï¼‰çš„æ•°ç»„vé‡å¡‘ä¸ºç»´åº¦ä¸º(a*b, 3)çš„å‘é‡ï¼Œåˆ™å¯ä»¥æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š

```python
v = v.reshape((v.shape[0]*v.shape[1], v.shape[2])) # v.shape[0] = a ; v.shape[1] = b ; v.shape[2] = c
```

-è¯·ä¸è¦å°†å›¾åƒçš„å°ºå¯¸ç¡¬ç¼–ç ä¸ºå¸¸æ•°ã€‚è€Œæ˜¯é€šè¿‡image.shape [0]ç­‰æ¥æŸ¥æ‰¾æ‰€éœ€çš„æ•°é‡ã€‚

```python
def image2vector(image):

    v = image.reshape(image.shape[0] * image.shape[1] * image.shape[2], 1)

    return v



image = np.array([[[ 0.67826139,  0.29380381],
        [ 0.90714982,  0.52835647],
        [ 0.4215251 ,  0.45017551]],

       [[ 0.92814219,  0.96677647],
        [ 0.85304703,  0.52351845],
        [ 0.19981397,  0.27417313]],

       [[ 0.60659855,  0.00533165],
        [ 0.10820313,  0.49978937],
        [ 0.34144279,  0.94630077]]])

print ("image2vector(image) = " + str(image2vector(image)))
```

output:

```python
image2vector(image) = [[0.67826139]
 [0.29380381]
 [0.90714982]
 [0.52835647]
 [0.4215251 ]
 [0.45017551]
 [0.92814219]
 [0.96677647]
 [0.85304703]
 [0.52351845]
 [0.19981397]
 [0.27417313]
 [0.60659855]
 [0.00533165]
 [0.10820313]
 [0.49978937]
 [0.34144279]
 [0.94630077]]
```

### 1.4-è¡Œæ ‡å‡†åŒ–

â€‹	å¯¹æ•°æ®è¿›è¡Œæ ‡å‡†åŒ–ï¼ˆå½’ä¸€åŒ–ï¼‰ã€‚ ç”±äºå½’ä¸€åŒ–åæ¢¯åº¦ä¸‹é™çš„æ”¶æ•›é€Ÿåº¦æ›´å¿«ï¼Œé€šå¸¸ä¼šè¡¨ç°å‡ºæ›´å¥½çš„æ•ˆæœã€‚ é€šè¿‡å½’ä¸€åŒ–ï¼Œä¹Ÿå°±æ˜¯å°†xæ›´æ”¹ä¸º![image-20240523141832233](images/image-20240523141832233.png)ï¼ˆå°†xçš„æ¯ä¸ªè¡Œå‘é‡é™¤ä»¥å…¶èŒƒæ•°ï¼ˆæ¨¡å€¼ï¼‰)ã€‚

ä¾‹å¦‚ï¼š

![image-20240523141947128](images/image-20240523141947128.png)

then

![image-20240523141954325](images/image-20240523141954325.png)

and

![image-20240523141958558](images/image-20240523141958558.png)

**ç»ƒä¹ **ï¼šæ‰§è¡Œ normalizeRowsï¼ˆï¼‰æ¥æ ‡å‡†åŒ–çŸ©é˜µçš„è¡Œã€‚ å°†æ­¤å‡½æ•°åº”ç”¨äºè¾“å…¥çŸ©é˜µxä¹‹åï¼Œxçš„æ¯ä¸€è¡Œåº”ä¸ºå•ä½é•¿åº¦ï¼ˆå³é•¿åº¦ä¸º1ï¼‰å‘é‡ã€‚

```python
#linalg = linearï¼ˆçº¿æ€§ï¼‰+ algebraï¼ˆä»£æ•°ï¼‰ï¼Œnormåˆ™è¡¨ç¤ºèŒƒæ•°ã€‚
#x_norm=np.linalg.norm(x, ord=None, axis=None, keepdims=False)
```

- x: è¡¨ç¤ºçŸ©é˜µï¼ˆä¹Ÿå¯ä»¥æ˜¯ä¸€ç»´ï¼‰

- ordï¼šèŒƒæ•°ç±»å‹

  ![image-20240523142909611](images/image-20240523142909611.png)

- axis, axis=0 è¡¨ç¤ºæŒ‰åˆ—å‘é‡æ¥è¿›è¡Œå¤„ç†ï¼Œæ±‚å¤šä¸ªåˆ—å‘é‡çš„èŒƒæ•°; axis =1 è¡¨ç¤ºæŒ‰è¡Œå‘é‡æ¥è¿›è¡Œå¤„ç†ï¼Œæ±‚å¤šä¸ªè¡Œå‘é‡çš„èŒƒæ•°

- keepdimsï¼šè¡¨ç¤ºæ˜¯å¦ä¿æŒçŸ©é˜µçš„äºŒç»´ç‰¹æ€§ï¼ŒTrueè¡¨ç¤ºä¿æŒï¼ŒFalseè¡¨ç¤ºä¸ä¿æŒï¼Œé»˜è®¤ä¸ºFalse

```python
def normalizeRows(x):
    x_norm = np.linalg.norm(x, axis = 1, keepdims = True)
    # Divide x by its norm.
    x = x / x_norm
    ### END CODE HERE ###

    return x

x = np.array([
    [0, 3, 4],
    [1, 6, 4]])
print("normalizeRows(x) = " + str(normalizeRows(x)))
```

outputï¼š

```PYTHON
normalizeRows(x) = [[0.         0.6        0.8       ]
 [0.13736056 0.82416338 0.54944226]]
```

**æ³¨æ„**ï¼š
åœ¨normalizeRowsï¼ˆï¼‰ä¸­ï¼Œå°è¯•printæŸ¥çœ‹ x_normå’Œxçš„ç»´åº¦ï¼Œ ä¼šå‘ç°å®ƒä»¬å…·æœ‰ä¸åŒçš„wç»´åº¦ã€‚ é‰´äºx_normé‡‡ç”¨xçš„æ¯ä¸€è¡Œçš„èŒƒæ•°ï¼Œè¿™æ˜¯æ­£å¸¸çš„ã€‚ å› æ­¤ï¼Œx_normå…·æœ‰ç›¸åŒçš„è¡Œæ•°ï¼Œä½†åªæœ‰1åˆ—ã€‚ é‚£ä¹ˆï¼Œå½“ä½ å°†xé™¤ä»¥x_normæ—¶ï¼Œå®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ è¿™å°±æ˜¯æ‰€è°“çš„å¹¿æ’­broadcastingï¼Œæˆ‘ä»¬ç°åœ¨å°†è®¨è®ºå®ƒï¼

æ­¤å¤„å¯¹åº”çš„æ˜¯ç¬”è®°ä¸­çš„å¹¿æ’­ï¼Œé€šä¿—æ¥è®²å°±æ˜¯ä¼šæ™ºèƒ½åŒ–è§£å†³ç»´åº¦ä¸åŒ¹é…çš„é—®é¢˜ã€‚

### 1.5- å¹¿æ’­å’Œsoftmaxå‡½æ•°

åœ¨numpyä¸­è¦ç†è§£çš„ä¸€ä¸ªéå¸¸é‡è¦çš„æ¦‚å¿µæ˜¯â€œå¹¿æ’­â€ã€‚ è¿™å¯¹äºåœ¨ä¸åŒå½¢çŠ¶çš„æ•°ç»„ä¹‹é—´æ‰§è¡Œæ•°å­¦è¿ç®—éå¸¸æœ‰ç”¨ã€‚

**ç»ƒä¹ **: ä½¿ç”¨numpyå®ç°softmaxå‡½æ•°ã€‚ ä½ å¯ä»¥å°†softmaxç†è§£ä¸ºç®—æ³•éœ€è¦å¯¹ä¸¤ä¸ªæˆ–å¤šä¸ªç±»è¿›è¡Œåˆ†ç±»æ—¶ä½¿ç”¨çš„æ ‡å‡†åŒ–å‡½æ•°ã€‚

â€‹	ç®€è€Œè¨€ä¹‹ï¼Œè¾“å…¥ä¸€ä¸ªçŸ©é˜µï¼Œå–eæŒ‡æ•°åæ¯è¡Œè¿›è¡Œå•ä½åŒ–ï¼Œå¯¹äºè¿™ä¸ªå‡½æ•°æœ‰ä»€ä¹ˆä½œç”¨å°†åœ¨æœ¬ä¸“ä¸šçš„ç¬¬äºŒé—¨è¯¾ä¸­äº†è§£æœ‰å…³softmaxçš„æ›´å¤šä¿¡æ¯ã€‚

![image-20240523144022058](images/image-20240523144022058.png)

```python
def softmax(x):

    x_exp = np.exp(x)

    x_sum = np.sum(x_exp, axis = 1, keepdims = True)

    s = x_exp / x_sum
    
    return s


x = np.array([
    [9, 2, 5, 0, 0],
    [7, 5, 0, 0 ,0]])
print("softmax(x) = " + str(softmax(x)))
```

output:

```PYTHON
softmax(x) = [[9.80897665e-01 8.94462891e-04 1.79657674e-02 1.21052389e-04
  1.21052389e-04]
 [8.78679856e-01 1.18916387e-01 8.01252314e-04 8.01252314e-04
  8.01252314e-04]]
```

## 2-å‘é‡åŒ–

â€‹	åœ¨æ·±åº¦å­¦ä¹ ä¸­ï¼Œé€šå¸¸éœ€è¦å¤„ç†éå¸¸å¤§çš„æ•°æ®é›†ã€‚ å› æ­¤ï¼Œéè®¡ç®—æœ€ä½³å‡½æ•°å¯èƒ½ä¼šæˆä¸ºç®—æ³•ä¸­çš„å·¨å¤§ç“¶é¢ˆï¼Œå¹¶å¯èƒ½ä½¿æ¨¡å‹è¿è¡Œä¸€æ®µæ—¶é—´ã€‚ ä¸ºäº†ç¡®ä¿ä»£ç çš„é«˜æ•ˆè®¡ç®—ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨å‘é‡åŒ–ã€‚ ä¾‹å¦‚ï¼Œå°è¯•åŒºåˆ†ç‚¹/å¤–éƒ¨/å…ƒç´ ä¹˜ç§¯ä¹‹é—´çš„åŒºåˆ«ã€‚

â€‹	ä¸‹æ–¹è¿ç®—æ—¶é—´ä¸º0ï¼Œdicã€docç›¸åŒï¼Œç”µè„‘è¿ç®—å¤ªå¿«ï¼Œä»£ç å¤ªå°‘ï¼Œformatå‡½æ•°ç²¾ç¡®åˆ°åå…«ä½éƒ½æ˜¯0ã€‚

â€‹	ä½†å¤§è¿ç®—é‡é¿å…ä½¿ç”¨æ˜¾ç¤ºforï¼Œä½¿ç”¨npå‡½æ•°åº“ã€‚

### **ç‚¹ç§¯(dot product)**

åˆå«æ ‡é‡ç§¯ã€æ•°é‡ç§¯ã€‚

â€‹	![image-20240523163946065](images/image-20240523163946065.png)

forç‰ˆæœ¬ï¼š

```python
import time

x1 = [9, 2, 5, 0, 0, 7, 5, 0, 0, 0, 9, 2, 5, 0, 0]
x2 = [9, 2, 2, 9, 0, 9, 2, 5, 0, 0, 9, 2, 5, 0, 0]

### CLASSIC DOT PRODUCT OF VECTORS IMPLEMENTATION ###
tic = time.process_time()
dot = 0
for i in range(len(x1)):
    dot+= x1[i]*x2[i]
toc = time.process_time()
print ("dot = " + str(dot) + "\n ----- Computation time = " + str(1000*(toc - tic)) + "ms")
```

npç‰ˆæœ¬ï¼š

```PYTHON
x1 = [9, 2, 5, 0, 0, 7, 5, 0, 0, 0, 9, 2, 5, 0, 0]
x2 = [9, 2, 2, 9, 0, 9, 2, 5, 0, 0, 9, 2, 5, 0, 0]

### VECTORIZED DOT PRODUCT OF VECTORS ###
tic = time.process_time()
dot = np.dot(x1,x2)
toc = time.process_time()
print ("dot = " + str(dot) + "\n ----- Computation time = " + str(1000*(toc - tic)) + "ms")
```



output:

```PYTHON
dot = 278
 ----- Computation time = 0.0ms
```



### **å‰ç§¯(corss product)**

â€‹	æˆ–å‘é‡ç§¯(vector product )

![image-20240523164123958](images/image-20240523164123958.png)

### **å¤–ç§¯(outer product)**

åœ¨çº¿æ€§ä»£æ•°ä¸­ï¼Œä¸¤ä¸ªåæ ‡å‘é‡çš„å¤–ç§¯æ˜¯ä¸€ä¸ªçŸ©é˜µã€‚å¦‚æœè¿™ä¸¤ä¸ªå‘é‡çš„ç»´åº¦æ˜¯*n*å’Œ*m*ï¼Œé‚£ä¹ˆå®ƒä»¬çš„å¤–ç§¯æ˜¯ä¸€ä¸ª*n* Ã— *m*çŸ©é˜µã€‚æ›´ä¸€èˆ¬åœ°è¯´ï¼Œç»™å®šä¸¤ä¸ªå¼ é‡ï¼ˆå¤šç»´æ•°å­—æ•°ç»„ï¼‰ï¼Œå®ƒä»¬çš„å¤–ç§¯æ˜¯å¼ é‡ã€‚å¼ é‡çš„å¤–ç§¯ä¹Ÿç§°ä¸ºå¼ é‡ç§¯ï¼Œå¯ç”¨äºå®šä¹‰å¼ é‡ä»£æ•°ã€‚

![image-20240523164405819](images/image-20240523164405819.png)

forç‰ˆæœ¬:

```PYTHON
### CLASSIC OUTER PRODUCT IMPLEMENTATION ###
tic = time.process_time()
outer = np.zeros((len(x1),len(x2))) # we create a len(x1)*len(x2) matrix with only zeros
for i in range(len(x1)):
    for j in range(len(x2)):
        outer[i,j] = x1[i]*x2[j]
toc = time.process_time()
print ("outer = " + str(outer) + "\n ----- Computation time = " + str(1000*(toc - tic)) + "ms")
```

npç‰ˆæœ¬ï¼š

```PYTHON
### VECTORIZED OUTER PRODUCT ###
tic = time.process_time()
outer = np.outer(x1,x2)
toc = time.process_time()
print ("outer = " + str(outer) + "\n ----- Computation time = " + str(1000*(toc - tic)) + "ms")
```



output:

```PYTHON
outer = [[81. 18. 18. 81.  0. 81. 18. 45.  0.  0. 81. 18. 45.  0.  0.]
 [18.  4.  4. 18.  0. 18.  4. 10.  0.  0. 18.  4. 10.  0.  0.]
 [45. 10. 10. 45.  0. 45. 10. 25.  0.  0. 45. 10. 25.  0.  0.]
 [ 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.]
 [ 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.]
 [63. 14. 14. 63.  0. 63. 14. 35.  0.  0. 63. 14. 35.  0.  0.]
 [45. 10. 10. 45.  0. 45. 10. 25.  0.  0. 45. 10. 25.  0.  0.]
 [ 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.]
 [ 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.]
 [ 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.]
 [81. 18. 18. 81.  0. 81. 18. 45.  0.  0. 81. 18. 45.  0.  0.]
 [18.  4.  4. 18.  0. 18.  4. 10.  0.  0. 18.  4. 10.  0.  0.]
 [45. 10. 10. 45.  0. 45. 10. 25.  0.  0. 45. 10. 25.  0.  0.]
 [ 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.]
 [ 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.]]
 ----- Computation time = 0.0ms
```

â€‹	ä¸åŒäº`np.multiply()`å’Œ`*` æ“ä½œç¬¦ï¼ˆç›¸å½“äºMatlab / Octaveä¸­çš„ `.*`ï¼‰æ‰§è¡Œé€å…ƒç´ çš„ä¹˜æ³•ï¼Œ`np.dot()`æ‰§è¡Œçš„æ˜¯çŸ©é˜µ-çŸ©é˜µæˆ–çŸ©é˜µå‘é‡ä¹˜æ³•ï¼Œ

### 2.1-å®ç°L1å’ŒL2æŸå¤±å‡½æ•°

**ç»ƒä¹ **ï¼šå®ç°L1æŸå¤±å‡½æ•°çš„Numpyå‘é‡åŒ–ç‰ˆæœ¬ã€‚ æˆ‘ä»¬ä¼šå‘ç°å‡½æ•°absï¼ˆxï¼‰ï¼ˆxçš„ç»å¯¹å€¼ï¼‰å¾ˆæœ‰ç”¨ã€‚

**æç¤º**ï¼š
-æŸå¤±å‡½æ•°ç”¨äºè¯„ä¼°æ¨¡å‹çš„æ€§èƒ½ã€‚ æŸå¤±è¶Šå¤§ï¼Œé¢„æµ‹![image-20240523170837643](images/image-20240523170837643.png) ä¸çœŸå®å€¼![image-20240523170844510](images/image-20240523170844510.png)çš„å·®å¼‚ä¹Ÿå°±è¶Šå¤§ã€‚ åœ¨æ·±åº¦å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨è¯¸å¦‚Gradient Descentä¹‹ç±»çš„ä¼˜åŒ–ç®—æ³•æ¥è®­ç»ƒæ¨¡å‹å¹¶æœ€å¤§ç¨‹åº¦åœ°é™ä½æˆæœ¬ã€‚

- L1æŸå¤±å‡½æ•°å®šä¹‰ä¸ºï¼š

![image-20240523170721050](images/image-20240523170721050.png)

```PYTHON
def L1(yhat, y):
    loss = np.sum(np.abs(y - yhat))
    return loss

yhat = np.array([.9, 0.2, 0.1, .4, .9])
y = np.array([1, 0, 0, 1, 1])
print("L1 = " + str(L1(yhat,y)))
```

output:

```python
L1 = 1.1
```

**ç»ƒä¹ **ï¼šå®ç°L2æŸå¤±å‡½æ•°çš„Numpyå‘é‡åŒ–ç‰ˆæœ¬ã€‚ æœ‰å¥½å‡ ç§æ–¹æ³•å¯ä»¥å®ç°L2æŸå¤±å‡½æ•°ï¼Œä½†æ˜¯è¿˜æ˜¯np.dotï¼ˆï¼‰å‡½æ•°æ›´å¥½ç”¨ã€‚ æé†’ä¸€ä¸‹ï¼Œå¦‚æœğ‘¥=[ğ‘¥1,ğ‘¥2,...,ğ‘¥ğ‘›]ï¼Œåˆ™`np.dotï¼ˆxï¼Œxï¼‰`=![image-20240523171230965](images/image-20240523171230965.png)

- L2æŸå¤±å‡½æ•°å®šä¹‰ä¸ºï¼š

![image-20240523171322543](images/image-20240523171322543.png)

æ­¤ç§ç®—æ³•æ˜¯ä¸Šè¿°æåˆ°çš„çŸ©é˜µçš„ç‚¹ç§¯ç®—æ³•ã€‚

```python
def L2(yhat, y):
    loss = np.dot((y - yhat),(y - yhat).T)
    return loss


yhat = np.array([.9, 0.2, 0.1, .4, .9])
y = np.array([1, 0, 0, 1, 1])
print("L2 = " + str(L2(yhat,y)))
```

output:

```python
L2 = 0.43
```

# ç”¨ç¥ç»ç½‘ç»œæ€æƒ³å®ç°Logisticå›å½’

## 1- å®‰è£…åŒ…

**ä½ å°†å­¦ä¹ ä»¥ä¸‹å†…å®¹ï¼š**

- å»ºç«‹å­¦ä¹ ç®—æ³•çš„ä¸€èˆ¬æ¶æ„ï¼ŒåŒ…æ‹¬ï¼š
  - åˆå§‹åŒ–å‚æ•°
  - è®¡ç®—æŸå¤±å‡½æ•°åŠå…¶æ¢¯åº¦
  - ä½¿ç”¨ä¼˜åŒ–ç®—æ³•ï¼ˆæ¢¯åº¦ä¸‹é™ï¼‰
- æŒ‰æ­£ç¡®çš„é¡ºåºå°†ä»¥ä¸Šæ‰€æœ‰ä¸‰ä¸ªåŠŸèƒ½é›†æˆåˆ°ä¸€ä¸ªä¸»æ¨¡å‹ä¸Šã€‚

```python
import numpy as np
import matplotlib.pyplot as plt
import h5py
import scipy
from PIL import Image
from scipy import ndimage
from lr_utils import load_dataset #è‡ªå»ºåº“ï¼Œä¸å¤§å¾ˆå°ï¼Œç½‘ä¸Šå¯æ‰¾åˆ°ã€‚
```

## 2- æ•°æ®é›†

**é—®é¢˜è¯´æ˜**ï¼šä½ å°†è·å¾—ä¸€ä¸ªåŒ…å«ä»¥ä¸‹å†…å®¹çš„æ•°æ®é›†ï¼ˆ"data.h5"ï¼‰ï¼š

-    æ ‡è®°ä¸ºcatï¼ˆy = 1ï¼‰æˆ–écatï¼ˆy = 0ï¼‰çš„**m_train**è®­ç»ƒå›¾åƒé›†
-    æ ‡è®°ä¸ºcatæˆ–non-catçš„**m_test**æµ‹è¯•å›¾åƒé›†
-    å›¾åƒç»´åº¦ä¸ºï¼ˆnum_pxï¼Œnum_pxï¼Œ3ï¼‰ï¼Œå…¶ä¸­3è¡¨ç¤º3ä¸ªé€šé“ï¼ˆRGBï¼‰ã€‚ å› æ­¤ï¼Œæ¯ä¸ªå›¾åƒéƒ½æ˜¯æ­£æ–¹å½¢ï¼ˆé«˜åº¦= num_pxï¼‰å’Œï¼ˆå®½åº¦= num_pxï¼‰ã€‚

ä½ å°†æ„å»ºä¸€ä¸ªç®€å•çš„å›¾åƒè¯†åˆ«ç®—æ³•ï¼Œè¯¥ç®—æ³•å¯ä»¥å°†å›¾ç‰‡æ­£ç¡®åˆ†ç±»ä¸ºçŒ«å’ŒéçŒ«ã€‚
è®©æˆ‘ä»¬ç†Ÿæ‚‰ä¸€ä¸‹æ•°æ®é›†å§ï¼Œ é¦–å…ˆé€šè¿‡è¿è¡Œä»¥ä¸‹ä»£ç æ¥åŠ è½½æ•°æ®ã€‚

```python
# Loading the data (cat/non-cat)
train_set_x_orig, train_set_y, test_set_x_orig, test_set_y, classes = load_dataset()

print("train_set_x shape: " + str(train_set_x_orig.shape))
print("train_set_y shape: " + str(train_set_y.shape))
print("test_set_x shape: " + str(test_set_x_orig.shape))
print("test_set_y shape: " + str(test_set_y.shape))
```

æˆ‘ä»¬åœ¨å›¾åƒæ•°æ®é›†ï¼ˆè®­ç»ƒå’Œæµ‹è¯•ï¼‰çš„æœ«å°¾æ·»åŠ äº†"_orig"ï¼Œä»¥ä¾¿å¯¹å…¶è¿›è¡Œé¢„å¤„ç†ã€‚ é¢„å¤„ç†åï¼Œæˆ‘ä»¬å°†å¾—åˆ°train_set_xå’Œtest_set_xï¼ˆæ ‡ç­¾train_set_yå’Œtest_set_yä¸éœ€è¦ä»»ä½•é¢„å¤„ç†ï¼‰ã€‚

- **train_set_x_orig** ï¼šä¿å­˜çš„æ˜¯è®­ç»ƒé›†é‡Œé¢çš„å›¾åƒæ•°æ®ï¼ˆæœ¬è®­ç»ƒé›†æœ‰209å¼ 64x64çš„å›¾åƒï¼‰ã€‚
- **train_set_y_orig** ï¼šä¿å­˜çš„æ˜¯è®­ç»ƒé›†çš„å›¾åƒå¯¹åº”çš„åˆ†ç±»å€¼ï¼ˆã€0 | 1ã€‘ï¼Œ0è¡¨ç¤ºä¸æ˜¯çŒ«ï¼Œ1è¡¨ç¤ºæ˜¯çŒ«ï¼‰ã€‚
- **test_set_x_orig** ï¼šä¿å­˜çš„æ˜¯æµ‹è¯•é›†é‡Œé¢çš„å›¾åƒæ•°æ®ï¼ˆæœ¬è®­ç»ƒé›†æœ‰50å¼ 64x64çš„å›¾åƒï¼‰ã€‚
- **test_set_y_orig** ï¼š ä¿å­˜çš„æ˜¯æµ‹è¯•é›†çš„å›¾åƒå¯¹åº”çš„åˆ†ç±»å€¼ï¼ˆã€0 | 1ã€‘ï¼Œ0è¡¨ç¤ºä¸æ˜¯çŒ«ï¼Œ1è¡¨ç¤ºæ˜¯çŒ«ï¼‰ã€‚
- **classes** ï¼š ä¿å­˜çš„æ˜¯ä»¥bytesç±»å‹ä¿å­˜çš„ä¸¤ä¸ªå­—ç¬¦ä¸²æ•°æ®ï¼Œæ•°æ®ä¸ºï¼š[bâ€™non-catâ€™ bâ€™catâ€™]ã€‚

train_set_x_origå’Œtest_set_x_origçš„æ¯ä¸€è¡Œéƒ½æ˜¯ä»£è¡¨å›¾åƒçš„æ•°ç»„ã€‚ ä½ å¯ä»¥é€šè¿‡è¿è¡Œä»¥ä¸‹ä»£ç æ¥å¯è§†åŒ–ç¤ºä¾‹ã€‚ è¿˜å¯ä»¥éšæ„æ›´æ”¹`index`å€¼å¹¶é‡æ–°è¿è¡Œä»¥æŸ¥çœ‹å…¶ä»–å›¾åƒã€‚

```python
# Example of a picture
index = 5
plt.imshow(train_set_x_orig[index])
plt.show()  #ä½¿ç”¨vscodeæ—¶ï¼Œæ·»åŠ è¿™ä¸ªæ‰ä¼šæ˜¾ç¤ºï¼Œå¹¶éåœ¨ipythonnoteä¸­è¿è¡Œã€‚
print ("y = " + str(train_set_y[:, index]) + ", it's a '" + classes[np.squeeze(train_set_y[:, index])].decode("utf-8") +  "' picture.")
```

outputï¼š

```python
y = [0], it's a 'non-cat' picture.
```

![image-20240523175255830](images/image-20240523175255830.png)

æ·±åº¦å­¦ä¹ ä¸­çš„è®¸å¤šæŠ¥é”™éƒ½æ¥è‡ªäºçŸ©é˜µ/å‘é‡å°ºå¯¸ä¸åŒ¹é…ã€‚ å¦‚æœä½ å¯ä»¥ä¿æŒçŸ©é˜µ/å‘é‡çš„å°ºå¯¸ä¸å˜ï¼Œé‚£ä¹ˆå°†æ¶ˆé™¤å¤§å¤šé”™è¯¯ã€‚

**ç»ƒä¹ ï¼š** æŸ¥æ‰¾ä»¥ä¸‹å„é¡¹çš„å€¼ï¼š

-    m_trainï¼ˆè®­ç»ƒé›†ç¤ºä¾‹æ•°é‡ï¼‰
-    m_testï¼ˆæµ‹è¯•é›†ç¤ºä¾‹æ•°é‡ï¼‰
-    num_pxï¼ˆ=è®­ç»ƒå›¾åƒçš„é«˜åº¦=è®­ç»ƒå›¾åƒçš„å®½åº¦ï¼‰

â€œ train_set_x_origâ€æ˜¯ä¸€ä¸ªç»´åº¦ä¸ºï¼ˆm_trainï¼Œnum_pxï¼Œnum_pxï¼Œ3ï¼‰çš„numpyæ•°ç»„ã€‚

```python
### START CODE HERE ### (â‰ˆ 3 lines of code)
m_train = train_set_x_orig.shape[0]
m_test = test_set_x_orig.shape[0]
num_px = train_set_x_orig.shape[1]
### END CODE HERE ###

print ("Number of training examples: m_train = " + str(m_train))
print ("Number of testing examples: m_test = " + str(m_test))
print ("Height/Width of each image: num_px = " + str(num_px))
print ("Each image is of size: (" + str(num_px) + ", " + str(num_px) + ", 3)")
print ("train_set_x shape: " + str(train_set_x_orig.shape))
print ("train_set_y shape: " + str(train_set_y.shape))
print ("test_set_x shape: " + str(test_set_x_orig.shape))
print ("test_set_y shape: " + str(test_set_y.shape))
```

outputï¼š

```python
Number of training examples: m_train = 209
Number of testing examples: m_test = 50
Height/Width of each image: num_px = 64
Each image is of size: (64, 64, 3)
train_set_x shape: (209, 64, 64, 3)
train_set_y shape: (1, 209)
test_set_x shape: (50, 64, 64, 3)
test_set_y shape: (1, 50)
```

ä¸ºäº†æ–¹ä¾¿èµ·è§ï¼Œä½ ç°åœ¨åº”è¯¥ä»¥ç»´åº¦(num_px âˆ— num_px âˆ— 3, 1)çš„numpyæ•°ç»„é‡å¡‘ç»´åº¦ï¼ˆnum_pxï¼Œnum_pxï¼Œ3ï¼‰çš„å›¾åƒã€‚ æ­¤åï¼Œæˆ‘ä»¬çš„è®­ç»ƒï¼ˆå’Œæµ‹è¯•ï¼‰æ•°æ®é›†æ˜¯ä¸€ä¸ªnumpyæ•°ç»„ï¼Œå…¶ä¸­æ¯åˆ—ä»£è¡¨ä¸€ä¸ªå±•å¹³çš„å›¾åƒã€‚ åº”è¯¥æœ‰m_trainï¼ˆå’Œm_testï¼‰åˆ—ã€‚

## 3-é¢„å¤„ç†æ•°æ®é›†

**ç»ƒä¹ ï¼š** é‡å¡‘è®­ç»ƒå’Œæµ‹è¯•æ•°æ®é›†ï¼Œä»¥ä¾¿å°†å¤§å°ï¼ˆnum_pxï¼Œnum_pxï¼Œ3ï¼‰çš„å›¾åƒå±•å¹³ä¸ºå•ä¸ªå½¢çŠ¶çš„å‘é‡(num_px âˆ— num_px âˆ— 3, 1)ã€‚

å°†ç»´åº¦ä¸ºï¼ˆaï¼Œbï¼Œcï¼Œdï¼‰çš„çŸ©é˜µXå±•å¹³ä¸ºå½¢çŠ¶ä¸º(bâˆ—câˆ—d, a)çš„çŸ©é˜µX_flattenæ—¶çš„ä¸€ä¸ªæŠ€å·§æ˜¯ï¼š

â€‹	åœ¨æŒ‡å®šç›®æ ‡ shape æ—¶å­˜åœ¨ä¸€äº›æŠ€å·§ï¼š

> - 1. -1 è¡¨ç¤ºè¿™ä¸ªç»´åº¦çš„å€¼æ˜¯ä» x çš„å…ƒç´ æ€»æ•°å’Œå‰©ä½™ç»´åº¦æ¨æ–­å‡ºæ¥çš„ã€‚å› æ­¤ï¼Œæœ‰ä¸”åªæœ‰ä¸€ä¸ªç»´åº¦å¯ä»¥è¢«è®¾ç½®ä¸º-1,åˆ©ç”¨å˜æ¢å‰åçš„å…ƒç´ æ•°å€¼ç›¸ç­‰æ¨æµ‹å‡ºæ¥ã€‚
> - 1. 0 è¡¨ç¤ºå®é™…çš„ç»´æ•°æ˜¯ä» x çš„å¯¹åº”ç»´æ•°ä¸­å¤åˆ¶å‡ºæ¥çš„ï¼Œå› æ­¤ shape ä¸­ 0 çš„ç´¢å¼•å€¼ä¸èƒ½è¶…è¿‡ x çš„ç»´åº¦ï¼Œç›´æ¥å¤åˆ¶å³å¯ã€‚

è¿™é‡Œæœ‰ä¸€äº›ä¾‹å­æ¥è§£é‡Šå®ƒä»¬ï¼š

> - 1ã€‚ç»™å®šä¸€ä¸ªå½¢çŠ¶ä¸º[2,4,6]çš„ä¸‰ç»´ Tensor xï¼Œç›®æ ‡å½¢çŠ¶ä¸º[6,8]ï¼Œåˆ™å°† x å˜æ¢ä¸ºå½¢çŠ¶ä¸º[6,8]çš„ 2-D Tensorï¼Œä¸” x çš„æ•°æ®ä¿æŒä¸å˜ã€‚
> - 2ã€‚ç»™å®šä¸€ä¸ªå½¢çŠ¶ä¸º[2,4,6]çš„ä¸‰ç»´ Tensor xï¼Œç›®æ ‡å½¢çŠ¶ä¸º[2,3,-1,2]ï¼Œåˆ™å°† x å˜æ¢ä¸ºå½¢çŠ¶ä¸º[2,3,4,2]çš„ 4-D Tensorï¼Œä¸” x çš„æ•°æ®ä¿æŒä¸å˜ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç›®æ ‡å½¢çŠ¶çš„ä¸€ä¸ªç»´åº¦è¢«è®¾ç½®ä¸º-1ï¼Œè¿™ä¸ªç»´åº¦çš„å€¼æ˜¯ä» x çš„å…ƒç´ æ€»æ•°å’Œå‰©ä½™ç»´åº¦æ¨æ–­å‡ºæ¥çš„ã€‚
> - 3ã€‚ç»™å®šä¸€ä¸ªå½¢çŠ¶ä¸º[2,4,6]çš„ä¸‰ç»´ Tensor xï¼Œç›®æ ‡å½¢çŠ¶ä¸º[-1,0,3,2]ï¼Œåˆ™å°† x å˜æ¢ä¸ºå½¢çŠ¶ä¸º[2,4,3,2]çš„ 4-D Tensorï¼Œä¸” x çš„æ•°æ®ä¿æŒä¸å˜ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ0 å¯¹åº”ä½ç½®çš„ç»´åº¦å€¼å°†ä» x çš„å¯¹åº”ç»´æ•°ä¸­å¤åˆ¶ï¼Œ-1 å¯¹åº”ä½ç½®çš„ç»´åº¦å€¼ç”± x çš„å…ƒç´ æ€»æ•°å’Œå‰©ä½™ç»´åº¦æ¨æ–­å‡ºæ¥ã€‚

```python
X_flatten = X.reshape(X.shape [0]ï¼Œ-1).T     # å…¶ä¸­X.Tæ˜¯Xçš„è½¬ç½®çŸ©é˜µ
```

å¤šæ•°æœºå™¨å­¦ä¹ ä»¥è¡Œä¸ºç‰¹å¾åˆ—ä¸ºæ ·æœ¬æ•°ã€‚

```python
# Reshape the training and test examples

### START CODE HERE ### (â‰ˆ 2 lines of code)
train_set_x_flatten = train_set_x_orig.reshape(train_set_x_orig.shape[0], -1).T
test_set_x_flatten = test_set_x_orig.reshape(test_set_x_orig.shape[0], -1).T
### END CODE HERE ###

print ("train_set_x_flatten shape: " + str(train_set_x_flatten.shape))
print ("train_set_y shape: " + str(train_set_y.shape))
print ("test_set_x_flatten shape: " + str(test_set_x_flatten.shape))
print ("test_set_y shape: " + str(test_set_y.shape))
print ("sanity check after reshaping: " + str(train_set_x_flatten[0:5,0]))
```

outputï¼š

```python
train_set_x_flatten shape: (12288, 209)
train_set_y shape: (1, 209)
test_set_x_flatten shape: (12288, 50)
test_set_y shape: (1, 50)
sanity check after reshaping: [17 31 56 22 33] #â€œç†æ™ºæ£€æŸ¥â€ï¼ˆsanity checkï¼‰ï¼Œç”¨äºéªŒè¯æ•°æ®æ˜¯å¦æŒ‰é¢„æœŸè¿›è¡Œäº†é‡å¡‘ã€‚ é€šè¿‡æ‰“å°æ•°ç»„ä¸€å°éƒ¨åˆ†ï¼Œé€šè¿‡è§†è§‰æ£€æŸ¥æ˜¯å¦ç¬¦åˆé¢„æœŸï¼Œé€‰å–å‰äº”ä¸ªæ ·æœ¬çš„ç¬¬ä¸€ä¸ªç‰¹å¾å€¼ã€‚
```

æœºå™¨å­¦ä¹ ä¸­ä¸€ä¸ªå¸¸è§çš„é¢„å¤„ç†æ­¥éª¤æ˜¯å¯¹æ•°æ®é›†è¿›è¡Œå±…ä¸­å’Œæ ‡å‡†åŒ–ï¼Œè¿™æ„å‘³ç€ä½ è¦ä»æ¯ä¸ªç¤ºä¾‹ä¸­å‡å»æ•´ä¸ªnumpyæ•°ç»„çš„å‡å€¼ï¼Œç„¶åé™¤ä»¥æ•´ä¸ªnumpyæ•°ç»„çš„æ ‡å‡†å·®ã€‚ä½†æ˜¯å›¾ç‰‡æ•°æ®é›†åˆ™æ›´ä¸ºç®€å•æ–¹ä¾¿ï¼Œå¹¶ä¸”åªè¦å°†æ•°æ®é›†çš„æ¯ä¸€è¡Œé™¤ä»¥255ï¼ˆåƒç´ é€šé“çš„æœ€å¤§å€¼ï¼‰ï¼Œæ•ˆæœä¹Ÿå·®ä¸å¤šã€‚

åœ¨è®­ç»ƒæ¨¡å‹æœŸé—´ï¼Œå°†è¦ä¹˜ä»¥æƒé‡å¹¶å‘ä¸€äº›åˆå§‹è¾“å…¥æ·»åŠ åå·®ä»¥è§‚å¯Ÿç¥ç»å…ƒçš„æ¿€æ´»ã€‚ç„¶åï¼Œä½¿ç”¨åå‘æ¢¯åº¦ä¼ æ’­ä»¥è®­ç»ƒæ¨¡å‹ã€‚ä½†æ˜¯ï¼Œè®©ç‰¹å¾å…·æœ‰ç›¸ä¼¼çš„èŒƒå›´ä»¥è‡³æ¸å˜ä¸ä¼šçˆ†ç‚¸æ˜¯éå¸¸é‡è¦çš„ï¼ˆåç»­ç« èŠ‚ï¼‰ã€‚

```python
train_set_x = train_set_x_flatten/255.
test_set_x = test_set_x_flatten/255.
```

é¢„å¤„ç†æ•°æ®é›†çš„å¸¸è§æ­¥éª¤æ˜¯ï¼š

- æ‰¾å‡ºæ•°æ®çš„å°ºå¯¸å’Œç»´åº¦ï¼ˆm_trainï¼Œm_testï¼Œnum_pxç­‰ï¼‰
- é‡å¡‘æ•°æ®é›†ï¼Œä»¥ä½¿æ¯ä¸ªç¤ºä¾‹éƒ½æ˜¯å¤§å°ä¸ºï¼ˆnum_px \*num_px \* 3ï¼Œ1ï¼‰çš„å‘é‡
- â€œæ ‡å‡†åŒ–â€æ•°æ®

## 4-ç®—æ³•çš„ä¸€èˆ¬æ¡†æ¶

ä½¿ç”¨ç¥ç»ç½‘ç»œæ€ç»´æ–¹å¼å»ºç«‹Logisticå›å½’ã€‚ ä¸‹å›¾è¯´æ˜äº†ä¸ºä»€ä¹ˆâ€œé€»è¾‘å›å½’å®é™…ä¸Šæ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„ç¥ç»ç½‘ç»œï¼â€

![image-20240523183605947](images/image-20240523183605947.png)

**ç®—æ³•çš„æ•°å­¦è¡¨è¾¾å¼**ï¼š

â€‹	å‰æ–¹éƒ½æ˜¯åœ¨é¢„æµ‹ï¼Œä¼¼ä¹åªæœ‰æŸå¤±å‡½æ•°å’Œæˆæœ¬å‡½æ•°æ˜¯ä¸è®­ç»ƒæœ‰å…³ç³»ï¼Œæˆæœ¬å‡½æ•°æœ€ç»ˆæ˜¯è¦æ±‚åå¯¼æˆwå’Œbçš„å‡½æ•°ï¼Œå› æ­¤å°±æ˜¯é€šè¿‡æˆæœ¬å‡½æ•°å’ŒæŸå¤±å‡½æ•°æ¥æ‰¾å¯»ä½¿å¾—Jæœ€å°çš„wå’Œbå‡½æ•°ã€‚

For one example![image-20240523183922055](images/image-20240523183922055.png)ï¼š

![image-20240523183932138](images/image-20240523183932138.png)

The cost is then computed by summing over all training examples:

![image-20240523184026470](images/image-20240523184026470.png)

**å…³é”®æ­¥éª¤**ï¼š

-    åˆå§‹åŒ–æ¨¡å‹å‚æ•°
-    é€šè¿‡æœ€å°åŒ–æŸå¤±æ¥å­¦ä¹ æ¨¡å‹çš„å‚æ•°
-    ä½¿ç”¨å­¦ä¹ åˆ°çš„å‚æ•°è¿›è¡Œé¢„æµ‹ï¼ˆåœ¨æµ‹è¯•é›†ä¸Šï¼‰
-    åˆ†æç»“æœå¹¶å¾—å‡ºç»“è®º

## 5-æ„å»ºç®—æ³•

å»ºç«‹ç¥ç»ç½‘ç»œçš„ä¸»è¦æ­¥éª¤æ˜¯ï¼š
1.å®šä¹‰æ¨¡å‹ç»“æ„ï¼ˆä¾‹å¦‚è¾“å…¥ç‰¹å¾çš„æ•°é‡ï¼‰
2.åˆå§‹åŒ–æ¨¡å‹çš„å‚æ•°
3.å¾ªç¯ï¼š

-    è®¡ç®—å½“å‰æŸå¤±ï¼ˆæ­£å‘ä¼ æ’­ï¼‰
-    è®¡ç®—å½“å‰æ¢¯åº¦ï¼ˆå‘åä¼ æ’­ï¼‰
-    æ›´æ–°å‚æ•°ï¼ˆæ¢¯åº¦ä¸‹é™ï¼‰

æ„å»º1-3ï¼Œé›†æˆåˆ°ä¸€ä¸ªç§°ä¸ºâ€œ modelï¼ˆï¼‰â€çš„å‡½æ•°ä¸­ã€‚

### 5.1- sigmoidå‡½æ•°(è¾…åŠ©å‡½æ•°)

```python
def sigmoid(z):
    s = 1 / (1 + np.exp(-z))
    return s
```

### 5.2- åˆå§‹åŒ–å‚æ•°

**ç»ƒä¹ ï¼š** å®ç°å‚æ•°åˆå§‹åŒ–ã€‚ ä½ å¿…é¡»å°†wåˆå§‹åŒ–ä¸ºé›¶çš„å‘é‡ä½¿ç”¨np.zerosï¼ˆï¼‰ã€‚

```python
def initialize_with_zeros(dim):
    w = np.zeros((dim, 1))
    b = 0

    assert(w.shape == (dim, 1))
    assert(isinstance(b, float) or isinstance(b, int))
    
    return w, b

dim = 2
w, b = initialize_with_zeros(dim)
print ("w = " + str(w))
print ("b = " + str(b))
```

outputï¼š

```PYTHON
w = [[0.]
 [0.]]
b = 0
```

### 5.3 å‰å‘å’Œåå‘ä¼ æ’­å‡½æ•°

**ç»ƒä¹ ï¼š** å®ç°å‡½æ•°propagateï¼ˆï¼‰æ¥è®¡ç®—æŸå¤±å‡½æ•°åŠå…¶æ¢¯åº¦ã€‚

æ­£å‘ä¼ æ’­ï¼š

- å¾—åˆ°X
- è®¡ç®—![image-20240523190723683](images/image-20240523190723683.png)
- è®¡ç®—æŸå¤±å‡½æ•°ï¼š![image-20240523190732001](images/image-20240523190732001.png)

ä½¿ç”¨åˆ°ä»¥ä¸‹ä¸¤ä¸ªå…¬å¼ï¼šå¯ä»ç¬”è®°ä¸­ä¸€æ­¥æ­¥æ¨å‡ºæ¥ã€‚

![image-20240523190754111](images/image-20240523190754111.png)

```python
def propagate(w, b, X, Y):
    m = X.shape[1]
    A = sigmoid(np.dot(w.T, X) + b)         
    cost = -1 / m * np.sum(Y * np.log(A) + (1 - Y) * np.log(1 - A))
    dw = 1 / m * np.dot(X, (A - Y).T)
    db = 1 / m * np.sum(A - Y)
    assert(dw.shape == w.shape)
    assert(db.dtype == float)
    cost = np.squeeze(cost) #ä»æ•°ç»„çš„å½¢çŠ¶ä¸­ç§»é™¤å•ç»´åº¦çš„æ¡ç›®ã€‚å¦‚ä¸€äº›æ•°ç»„ä¸º[2,2ï¼Œ1]ï¼Œå…¶å®è´¨å°±ä¸ºä¸€ä¸ªäºŒç»´æ•°ç»„ï¼Œä½†è¿™æ ·å†™ä¼šè¡¨ç°ä¸ºä¸‰ç»´æ•°ç»„ï¼Œå› æ­¤å¯ä»¥ç”¨squeezeå‡½æ•°å°†å…¶å˜ä¸º[2,2]
    assert(cost.shape == ())
    
    grads = {"dw": dw,
             "db": db}
    
    return grads, cost

w, b, X, Y = np.array([[1],[2]]), 2, np.array([[1,2],[3,4]]), np.array([[1,0]])
#w, b, X, Y = np.array([[1],[2],[3]]), 2, np.array([[1,2,3],[3,4,3],[5,6,3]]), np.array([[1,0,1]])
grads, cost = propagate(w, b, X, Y)
print ("dw = " + str(grads["dw"]))
print ("db = " + str(grads["db"]))
print ("cost = " + str(cost))
```

outputï¼š

```python
dw = [[0.99993216]
 [1.99980262]]
db = 0.49993523062470574
cost = 6.000064773192205
```

### 5.4-ä¼˜åŒ–å‡½æ•°

- åˆå§‹åŒ–å‚æ•°ã€‚
- è®¡ç®—æŸå¤±å‡½æ•°åŠå…¶æ¢¯åº¦ã€‚
- ä½¿ç”¨æ¢¯åº¦ä¸‹é™æ¥æ›´æ–°å‚æ•°ã€‚

**ç»ƒä¹ ï¼š** é€šè¿‡æœ€å°åŒ–æŸå¤±å‡½æ•° ğ½ æ¥å­¦ä¹  ğ‘¤ å’Œ ğ‘ã€‚ å¯¹äºå‚æ•°ğœƒï¼Œæ›´æ–°è§„åˆ™ä¸ºğœƒ=ğœƒâˆ’ğ›¼ ğ‘‘ğœƒï¼Œå…¶ä¸­ğ›¼æ˜¯å­¦ä¹ ç‡ã€‚

```python
def optimize(w, b, X, Y, num_iterations, learning_rate, print_cost = False):
    
    costs = []
    
    for i in range(num_iterations): #è¿­ä»£æ¬¡æ•°
        

        grads, cost = propagate(w, b, X, Y)


        dw = grads["dw"]
        db = grads["db"]

        w = w - learning_rate * dw
        b = b - learning_rate * db

        if i % 100 == 0:#è®°å½•æ¯éš”ä¸€å®šæ­¥éª¤ï¼ˆæ¯ 100 æ­¥ï¼‰çš„æŸå¤±å€¼ã€‚
            costs.append(cost)#å°†æŸå¤±å€¼ï¼ˆcostï¼‰æ·»åŠ åˆ°åä¸ºcostsçš„åˆ—è¡¨ä¸­ã€‚

        if print_cost and i % 100 == 0:
            print ("Cost after iteration %i: %f" %(i, cost))
    
    params = {"w": w,
              "b": b}
    
    grads = {"dw": dw,
             "db": db}
    
    return params, grads, costs

params, grads, costs = optimize(w, b, X, Y, num_iterations= 101, learning_rate = 0.009, print_cost = False)

print ("w = " + str(params["w"]))
print ("b = " + str(params["b"]))
print ("dw = " + str(grads["dw"]))
print ("db = " + str(grads["db"]))
print(costs)
```

outputï¼š

```PYTHON
w = [[0.10440664]
 [0.21535171]]
b = 1.5554725342883116
dw = [[0.89458411]
 [1.74622645]]
db = 0.4258211729530607
[6.000064773192205, 1.4313999565615696]
```

**ç»ƒä¹ ï¼š** ä¸Šä¸€ä¸ªå‡½æ•°å°†è¾“å‡ºå­¦ä¹ åˆ°çš„wå’Œbã€‚ æˆ‘ä»¬èƒ½å¤Ÿä½¿ç”¨wå’Œbæ¥é¢„æµ‹æ•°æ®é›†Xçš„æ ‡ç­¾ã€‚å®ç°`predictï¼ˆï¼‰`å‡½æ•°ã€‚ é¢„æµ‹åˆ†ç±»æœ‰ä¸¤ä¸ªæ­¥éª¤ï¼š
1.è®¡ç®—![image-20240523193405123](images/image-20240523193405123.png)
2.å°†açš„é¡¹è½¬æ¢ä¸º0ï¼ˆå¦‚æœæ¿€æ´»<= 0.5ï¼‰æˆ–1ï¼ˆå¦‚æœæ¿€æ´»> 0.5)ï¼Œå¹¶å°†é¢„æµ‹ç»“æœå­˜å‚¨åœ¨å‘é‡â€œ Y_predictionâ€ä¸­ã€‚ å¦‚æœæ„¿æ„ï¼Œå¯ä»¥åœ¨forå¾ªç¯ä¸­ä½¿ç”¨if / elseè¯­å¥ã€‚

```python
def predict(w, b, X):
    #æ­¤å¤„çš„Xå·²ç»æ˜¯è¢«é¢„å¤„ç†è¿‡åçš„ï¼Œå³å¤§å°ä¸º(X.shape[0],X.shape[1])è€Œä¸å†æ˜¯RGBä¸‰ç»´æ•°ç»„ã€‚
    m = X.shape[1]  #è·å–æ ·æœ¬æ•°
    Y_prediction = np.zeros((1,m)) #1è¡Œmåˆ—
    w = w.reshape(X.shape[0], 1)#wä¸ºxå¯¹åº”çš„è¡Œï¼Œ1åˆ—ï¼ˆåç»­è¦è½¬ç½®ï¼‰
    A = sigmoid(np.dot(w.T, X) + b)#y_hat

    for i in range(A.shape[1]):
        if A[0, i] <= 0.5:
            Y_prediction[0, i] = 0 #ä¸æ˜¯çŒ«
        else:
            Y_prediction[0, i] = 1 #çŒ«
    
    assert(Y_prediction.shape == (1, m)) 
    
    return Y_prediction

print ("predictions = " + str(predict(w, b, X)))
```

outputï¼š

```python
predictions = [[1. 1.]] #ç»“æœè¡¨ç¤ºæµ‹è¯•äº†ä¸¤å¼ å›¾ç‰‡ï¼Œéƒ½ä¸ºçŒ«ã€‚
```

## 6- å°†æ‰€æœ‰åŠŸèƒ½åˆå¹¶åˆ°æ¨¡å‹ä¸­

ç°åœ¨ï¼Œå°†æ‰€æœ‰æ„ä»¶ï¼ˆåœ¨ä¸Šä¸€éƒ¨åˆ†ä¸­å®ç°çš„åŠŸèƒ½ï¼‰ä»¥æ­£ç¡®çš„é¡ºåºæ”¾åœ¨ä¸€èµ·ï¼Œä»è€Œå¾—åˆ°æ•´ä½“çš„model()å‡½æ•°ã€‚

**ç»ƒä¹ ï¼š** å®ç°å‡½æ•°åŠŸèƒ½ï¼Œä½¿ç”¨ä»¥ä¸‹ç¬¦å·ï¼š

-    Y_predictionå¯¹æµ‹è¯•é›†çš„é¢„æµ‹
-    Y_prediction_trainå¯¹è®­ç»ƒé›†çš„é¢„æµ‹
-    wï¼ŒæŸå¤±ï¼Œoptimizeï¼ˆï¼‰è¾“å‡ºçš„æ¢¯åº¦

```python
def model(X_train, Y_train, X_test, Y_test, num_iterations = 2000, learning_rate = 0.5, print_cost = False):

    w, b = initialize_with_zeros(X_train.shape[0]) #å¯¹wå’Œbè¿›è¡Œä»¥Xè¡Œä¸ºæ•°çš„åˆå§‹åŒ–[dimï¼Œ1]

    parameters, grads, costs = optimize(w, b, X_train, Y_train, num_iterations, learning_rate, print_cost)

    w = parameters["w"]
    b = parameters["b"]#è®­ç»ƒåçš„

    Y_prediction_test = predict(w, b, X_test)
    Y_prediction_train = predict(w, b, X_train)

    print("train accuracy: {} %".format(100 - np.mean(np.abs(Y_prediction_train - Y_train)) * 100)) #100-ç»å¯¹è¯¯å·®ï¼ˆæ­¤å¤„è¯¯å·®å½’ä¸€åŒ–äº†ï¼Œå› æ­¤ä¹˜ä»¥100ï¼‰
    print("test accuracy: {} %".format(100 - np.mean(np.abs(Y_prediction_test - Y_test)) * 100))

    
    d = {"costs": costs,
         "Y_prediction_test": Y_prediction_test, 
         "Y_prediction_train" : Y_prediction_train, 
         "w" : w, #wä»0é€šè¿‡æ¢¯åº¦æ¥è®¡ç®—æƒé‡çŸ©é˜µï¼Œdwçš„å€¼é€šè¿‡ç…§ç‰‡è®¡ç®—ä¸ä¸€æ ·ã€‚
         "b" : b,
         "learning_rate" : learning_rate,
         "num_iterations": num_iterations}
    
    return d

```

â€‹	é€šè¿‡è®­ç»ƒé›†å¾—åˆ°æ¯å¼ ç…§ç‰‡dwï¼Œç„¶åè®¡ç®—æŸå¤±å‡½æ•°ï¼Œè¿›è€Œå¾—åˆ°æˆæœ¬å‡½æ•°ï¼Œdwçš„ä¸åŒå¯¼è‡´äº†æŸå¤±å‡½æ•°ä¸åŒï¼Œä»è€Œä½¿å¾—æ›´æ–°çš„wæƒé‡çŸ©é˜µä¸åŒã€‚

## 7- å­¦ä¹ ç‡çš„é€‰æ‹©

ä¸ºäº†ä½¿æ¢¯åº¦ä¸‹é™èµ·ä½œç”¨ï¼Œä½ å¿…é¡»æ˜æ™ºåœ°é€‰æ‹©å­¦ä¹ ç‡ã€‚ å­¦ä¹ ç‡ğ›¼å†³å®šæˆ‘ä»¬æ›´æ–°å‚æ•°çš„é€Ÿåº¦ã€‚ å¦‚æœå­¦ä¹ ç‡å¤ªå¤§ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šâ€œè¶…å‡ºâ€æœ€ä½³å€¼ã€‚ åŒæ ·ï¼Œå¦‚æœå¤ªå°ï¼Œå°†éœ€è¦æ›´å¤šçš„è¿­ä»£æ‰èƒ½æ”¶æ•›åˆ°æœ€ä½³å€¼ã€‚ è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆè°ƒæ•´å¥½å­¦ä¹ ç‡è‡³å…³é‡è¦ã€‚

è®©æˆ‘ä»¬å°†æ¨¡å‹çš„å­¦ä¹ æ›²çº¿ä¸é€‰æ‹©çš„å‡ ç§å­¦ä¹ ç‡è¿›è¡Œæ¯”è¾ƒã€‚ è¿è¡Œä¸‹é¢çš„å•å…ƒæ ¼ã€‚ è¿™å¤§çº¦éœ€è¦1åˆ†é’Ÿã€‚ è¿˜å¯ä»¥å°è¯•ä¸æˆ‘ä»¬åˆå§‹åŒ–è¦åŒ…å«çš„â€œ learning_ratesâ€å˜é‡çš„ä¸‰ä¸ªå€¼ä¸åŒçš„å€¼ï¼Œç„¶åçœ‹çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆã€‚

```python
learning_rates = [0.01, 0.001, 0.0001]
models = {}
for i in learning_rates:
    print ("learning rate is: " + str(i))
    models[str(i)] = model(train_set_x, train_set_y, test_set_x, test_set_y, num_iterations = 1500, learning_rate = i, print_cost = False)
    print ('\n' + "-------------------------------------------------------" + '\n')

for i in learning_rates:
    plt.plot(np.squeeze(models[str(i)]["costs"]), label= str(models[str(i)]["learning_rate"]))

plt.ylabel('cost')
plt.xlabel('iterations')

legend = plt.legend(loc='upper center', shadow=True)
frame = legend.get_frame()
frame.set_facecolor('0.90')
plt.show()
```

outputï¼š

```python
learning rate is: 0.01
train accuracy: 99.52153110047847 %
test accuracy: 68.0 %

-------------------------------------------------------

learning rate is: 0.001
train accuracy: 88.99521531100478 %
test accuracy: 64.0 %

-------------------------------------------------------

learning rate is: 0.0001
train accuracy: 68.42105263157895 %
test accuracy: 36.0 %

-------------------------------------------------------
```

![image-20240523212116574](images/image-20240523212116574.png)

## 8-ä½¿ç”¨è‡ªå·±çš„å›¾åƒè¿›è¡Œæµ‹è¯•

ç¥è´ºä½ å®Œæˆæ­¤ä½œä¸šã€‚ ä½ å¯ä»¥ä½¿ç”¨è‡ªå·±çš„å›¾åƒå¹¶æŸ¥çœ‹æ¨¡å‹çš„é¢„æµ‹è¾“å‡ºã€‚ è¦åšåˆ°è¿™ä¸€ç‚¹ï¼š
   1.å•å‡»æ­¤ç¬”è®°æœ¬ä¸Šéƒ¨æ ä¸­çš„ "File"ï¼Œç„¶åå•å‡»"Open" ä»¥åœ¨Coursera Hubä¸Šè¿è¡Œã€‚
   2.å°†å›¾åƒæ·»åŠ åˆ°Jupyter Notebookçš„ç›®å½•ä¸­ï¼Œåœ¨"images"æ–‡ä»¶å¤¹ä¸­
   3.åœ¨ä»¥ä¸‹ä»£ç ä¸­æ›´æ”¹å›¾åƒçš„åç§°
   4.è¿è¡Œä»£ç ï¼Œæ£€æŸ¥ç®—æ³•æ˜¯å¦æ­£ç¡®ï¼ˆ1 = catï¼Œ0 = non-catï¼‰ï¼

```python
fname = '/home/kesci/input/deeplearningai17761/cat_in_iran.jpg'#æ–‡ä»¶è·¯å¾„
image = np.array(plt.imread(fname))
my_image = scipy.misc.imresize(image, size=(num_px,num_px)).reshape((1, num_px*num_px*3)).T
my_predicted_image = predict(d["w"], d["b"], my_image)

plt.imshow(image)
print("y = " + str(np.squeeze(my_predicted_image)) + ", your algorithm predicts a \"" + classes[int(np.squeeze(my_predicted_image)),].decode("utf-8") +  "\" picture.")
```

# ç”¨1å±‚éšè—å±‚çš„ç¥ç»ç½‘ç»œåˆ†ç±»äºŒç»´æ•°æ®
